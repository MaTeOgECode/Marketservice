<div class="container-lista">
  <div class="header-section">
    <h2>Mis Servicios Publicados</h2>
    <p>Gestiona, edita o elimina tus ofertas actuales en el mercado.</p>
  </div>

  <div class="grid-servicios-pro">
    <div class="card-admin" *ngFor="let s of serviciosProveedor">
      <div class="img-preview">
        <img [src]="s.imagen" alt="Servicio">
        <div class="badge-status" [ngClass]="s.totalContratos > 0 ? 'contratado' : 'libre'">
          <i class="bi" [ngClass]="s.totalContratos > 0 ? 'bi-check-circle-fill' : 'bi-clock-history'"></i>
          {{ s.totalContratos > 0 ? 'CONTRATADO' : 'DISPONIBLE' }}
        </div>
      </div>
      
      <div class="info-content">
        <div class="meta-info">
          <span class="categoria-tag">{{ s.categoria }}</span>
        </div>
        <h3>{{ s.nombre }}</h3>
        <p class="descripcion-corta">{{ s.descripcion }}</p>
        <p class="precio-tag">Bs. {{ s.precio }}</p>
      </div>

      <div class="acciones-footer">
        <button class="btn-edit" (click)="abrirModal(s)">
          <i class="bi bi-pencil"></i> Editar
        </button>
        <button class="btn-del" (click)="eliminar(s.id)">
          <i class="bi bi-trash"></i> Eliminar
        </button>
      </div>
    </div>
  </div>

  <div class="modal-overlay animate-fade" *ngIf="mostrarModal">
    <div class="modal-content animate-slide-up">
      <div class="modal-header">
        <div class="header-text">
          <h3>Editar Servicio</h3>
          <span>Actualiza los detalles de tu publicación</span>
        </div>
        <button class="btn-close" (click)="cerrarModal()">&times;</button>
      </div>

      <div class="modal-body">
        <div class="form-group">
          <label>Nombre del Servicio</label>
          <input type="text" [(ngModel)]="servicioEdicion.nombre">
        </div>

        <div class="form-group">
          <label>Descripción</label>
          <textarea [(ngModel)]="servicioEdicion.descripcion" rows="3"></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Precio (Bs)</label>
            <input type="number" [(ngModel)]="servicioEdicion.precio">
          </div>
          <div class="form-group">
            <label>Categoría</label>
            <select [(ngModel)]="servicioEdicion.categoria">
              <option *ngFor="let cat of listaCategorias" [value]="cat.nombre">
                {{ cat.nombre }}
              </option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label>Cambiar Imagen</label>
          <input type="file" (change)="onFileSelected($event)" accept="image/*" class="custom-file-input">
          <div class="mini-preview" *ngIf="servicioEdicion.imagen">
            <img [src]="servicioEdicion.imagen" alt="Vista previa">
            <span>Imagen actual</span>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn-cancel" (click)="cerrarModal()">Cancelar</button>
        <button class="btn-save" (click)="guardarCambios()" [disabled]="cargando">
          {{ cargando ? 'Guardando...' : 'Guardar Cambios' }}
        </button>
      </div>
    </div>
  </div>
</div>